{% extends 'base.html' %}
{% load static %}
{% load currency_filters %}


{% block conteudo %}
<br>
<div class="container-xg py-5">
    <div class="col-12">
        <form method="GET" action=".">
            <div class="row justify-content-end">
                <div class="col-8 col-md-2 mb-3">
                    <select class="form-control" name="data_ano" id="data_ano">
                        <option value="">Escolha um ano</option>
                        <option value="2025" {% if data_ano == 2025 %}selected{% endif %}>2025</option>
                        <option value="2024" {% if data_ano == 2024 %}selected{% endif %}>2024</option>
                    </select>
                </div>
                <div class="col-4 col-md-1 mb-1">
                    <button type="submit" class="btn btn-secondary btn btn-block">Filtrar</button>
                </div>
            </div>
        </form>
    </div>
    <div class="table-responsive">
        <table class="table table-hover table-sm">
            <thead>
                <tr>
                    <th>Categoria</th>
                    <th class="text-right">01/{{data_ano}}</th>
                    <th class="text-right">02/{{data_ano}}</th>
                    <th class="text-right">03/{{data_ano}}</th>
                    <th class="text-right">04/{{data_ano}}</th>
                    <th class="text-right">05/{{data_ano}}</th>
                    <th class="text-right">06/{{data_ano}}</th>
                    <th class="text-right">07/{{data_ano}}</th>
                    <th class="text-right">08/{{data_ano}}</th>
                    <th class="text-right">09/{{data_ano}}</th>
                    <th class="text-right">10/{{data_ano}}</th>
                    <th class="text-right">11/{{data_ano}}</th>
                    <th class="text-right">12/{{data_ano}}</th>
                    <th class="text-right">Total</th>
                </tr>
            </thead>
            <tbody>
                {% for item in relatorio %}
                <tr>
                    <td class="{% if item.e_categoria_pai %}font-weight-bold bg-light{% endif %}">
                        {{ item.descricao }}
                    </td>
                    {% for valor in item.valor_mes %}
                        <td class="text-right {% if item.e_categoria_pai %}font-weight-bold{% endif %}">
                            {% if not item.e_categoria_pai %}
                                <a class="text-dark" href="{% url "fluxo:relatorio_lancamentos" %}?categoria={{item.id}}&data_inicio={{valor.3}}-{{valor.1}}-1&data_fim={{valor.3}}-{{valor.1}}-{{valor.2}}">
                                    {{ valor.0|currency }}
                                </a>
                            {% else %}
                                {{ valor.0|currency }}
                            {% endif %}
                        </td>
                    {% endfor %}
                    <td class="text-right {% if item.e_categoria_pai %}font-weight-bold{% endif %}">
                        {{ item.valor_total|currency }}
                    </td>
                </tr>
                {% endfor %}
                <tr class="font-weight-bold">
                    <td>RESULTADO</td>
                    {% for total in totais_colunas %}
                        <td class="text-right">{{ total|currency }}</td>
                    {% endfor %}
                    <td class="text-right">{{ resultado_total|currency }}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
{% endblock conteudo %}
